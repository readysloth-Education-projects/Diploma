\chapter{Исследовательский раздел}\label{ch:ch1}
\section{Процесс сертификации ПО на отсутствие НДВ}\label{sec:ch1/sec1}
Сертификация программного обеспечения проводится, 
когда необходимо подтвердить соответствие разрабатываемой 
продукции требованиям защиты информации.

Сертификационная процедура состоит из следующих этапов:
\begin{enumerate}
    \item Готовность документации ПО, доступность исходных текстов
    \item Опредление объема исходных текстов, подлежащих анализу
    \item Обращение заявителя в испытательную лабораторию с собранной информацией
    \item Анализ документации
    \item Разработка <<Программы и методик проведения сертификационных испытаний>>
    \item Проведение испытаний
    \item Экспертиза результатов
\end{enumerate}

Сертификация должна выявить присутствие в исполняемом файле недекларированных возможностей,
которые могут являться как злым умыслом\autocite{compile-a-virus, ken-thompson-hack} 
разработчиков компилятора, линкера и других вспомогательных программ,
так и методами оптимизации ПО, которые применяются для более рационального 
потребления ресурсов программой.

Выявить данные расхождения между необработанными исходными кодами и 
поведением программы во время исполнения позволяет разработанный мной
программный модуль.

Дадим определение термину <<Недекларированные возможности>>:

\textbf{Недекларированные возможности}\autocite{undeclared-capabilities-antimalware} 
— намеренно измененная часть ПО, с помощью которой можно получить незаметный 
несанкционированный доступ к безопасной компьютерной среде.

\section{Классификация НДВ}\label{sec:ch1/sec2}
    \subsection{По применению}\label{sec:ch1/sec2/sub1}
    \begin{itemize}
        \item \textbf{Перехват данных}
        \item \textbf{Подмена данных}
        \item \textbf{Вывод компьютерной системы из строя}
        \item \textbf{Полный доступ к удаленной компьютерной системе}

              Такие программы могут быть использованы злоумышленниками для
              всех вышеперечисленных целей
    \end{itemize}
\subsection{По целям}\label{sec:ch1/sec2/sub2}
\begin{itemize}
    \item \textbf{Персональные компьютеры и рабочие станции}
          
          Целью могут быть как персональные компьютеры широкого числа пользователей,
          так и отдельные рабочие станции, которые могут являться точкой входа в
          защищенную компьютерную систему, так и использоваться для перехвата важной
          информации
    \item \textbf{Серверы}
          
          Серверы обслуживают большое количество клиентов, а значит проникновение на
          сервер может существенно повлиять на работу всех компьютеров, работающих с
          данным сервером
    \item \textbf{Встраиваемые системы}

          Благодаря постоянному удешелению микроконтроллеров и периферийных устройств,
          все больше и больше повседневных вещей обзаводятся <<умной>> функциональностью.
          Погоня производителей за прибылями отражается на безопасности прошивок умных устройств.
    \item \textbf{Промышленные компьютеры}

        Программные закладки в такие системы чреваты шпионажем или диверсией\autocite{stuxnet}
        \footnote{Хотя данная программа является вирусом, а не программой с НДВ, случившееся
        ярко показывает реальное применение подобных техник для деструктивных действий}.
\end{itemize}

\section{Степень опасности НДВ}\label{sec:ch1/sec3}
Для определения опасности НДВ будем пользоваться следующими нормативными документами:
\begin{itemize}
    \item Приказ ФСТЭК России от 18 февраля 2013 г. № 21
    \item Федеральный закон "О персональных данных" от 27.07.2006 N 152-ФЗ
\end{itemize}

Тип угроз безопасности персональных данных определяется 
в зависимости от комбинаций актуальности угроз в ИСПДн (\autoref{table:threats}):
\begin{itemize}
    \item Наличием НДВ в системном программном обеспечении (ПО), используемом в ИСПДн
    \item Наличием НДВ в прикладном ПО, используемом в ИСПДн
\end{itemize}



\begin{table}[!htbp]
    \centering
    %\captionsetup{justification=centering}


    \begin{center}
        \begin{tabular}{ | c | c | c | c | }
            \hline
            Угрозы & \multicolumn{3}{ c |}{Тип актуальных угроз} \\
            \cline{2-4}
                   & 1 Тип & 2 Тип & 3 Тип\\
            \hline
            \makecell{Наличие НДВ в системном ПО,\\ используемом в ИСПДн} & \redcell{актуально} & \greencell{неактуально} & \redcell{неактуально} \\
            \hline
            \makecell{Наличие НДВ в прикладном ПО \\ используемом в ИСПДн} & \makecell{актуально \\ или \\ неактуально} & \redcell{актуально} & \greencell{неактуально} \\
            \hline
        \end{tabular}
    \end{center}

    \caption{\label{table:threats}Тип актуальных угроз}

\end{table}

Порядок определения актуальных угроз безопасности 
персональных данных в ИСПДн осуществляется 
в соответствии с Методикой определения 
актуальных угроз безопасности персональных данных 
при их обработке в информационных 
системах персональных данных, утвержденных 
ФСТЭК России, 2008 год.

Актуальной считается угроза, которая может быть 
реализована в ИСПДн и представляет опасность для 
персональных данных.  Подход к составлению перечня 
актуальных угроз состоит в следующем. 
Для оценки возможности реализации угрозы применяются два показателя: 

$Y_1$ - уровень исходной защищенности ИСПДн\\
$Y_2$ - частота (вероятность) реализации рассматриваемой угрозы.\\
Коэффициент реализуемости угрозы $Y$ определяется соотношением: 

\[Y = \frac{Y_1 + Y_2}{20}\]

По значению коэффициента реализуемости угрозы Y 
интерпретация реализуемости угрозы следующим образом: 
\begin{itemize}
    \item если $0 \leq Y \leq 0.3$, то возможность реализации угрозы признается низкой
    \item если $0.3 < Y \leq  0.6$, то возможность реализации угрозы признается средней 
    \item если $0.6 < Y \leq  0.8$, то возможность реализации угрозы признается высокой 
    \item если $Y > 0,8$, то возможность реализации угрозы признается очень высокой
\end{itemize}

Далее оценивается опасность каждой угрозы.
Этот показатель имеет три значения: 
\begin{itemize}
    \item низкая опасность – если реализация угрозы может привести к незначительным негативным последствиям для субъектов персональных данных
    \item средняя опасность – если реализация угрозы может привести к негативным последствиям для субъектов персональных данных
    \item высокая опасность – если реализация угрозы может привести к значительным негативным последствиям для субъектов персональных данных.
\end{itemize}

Затем осуществляется выбор из общего
перечня угроз безопасности тех, 
которые относятся к актуальным для данной ИСПДн,
в соответствии с правилами, приведенными в \autoref{table:actual-threats}
\begin{table}[!htbp]
    \centering
    %\captionsetup{justification=centering}

    \begin{center}
        \begin{tabular}{ | c | c | c | c | }
            \hline
            \makecell{Возможность \\ реализации угрозы} & \multicolumn{3}{ c |}{Показатель опасности угрозы} \\
            \cline{2-4}
                   & Низкая & Средняя & Высокая\\
            \hline
            \makecell{Низкая}        & \greencell{неактуальная} & \greencell{неактуальная} & \redcell{актуальная} \\
            \hline
            \makecell{Средняя}       & \greencell{неактуальная} & \redcell{актуальная}      & \redcell{актуальная} \\
            \hline
            \makecell{Высокая}       & \redcell{актуальная}      & \redcell{актуальная}      & \redcell{актуальная} \\
            \hline
            \makecell{Очень высокая} & \redcell{актуальная}      & \redcell{актуальная}      & \redcell{актуальная} \\
            \hline
        \end{tabular}
    \end{center}

    \caption{\label{table:actual-threats}Правила отнесения угрозы безопасности персональных данных к актуальной}

\end{table}

После чего выносится решение о проведении анализа ПО 
на НДВ в процесс сертификации или его игнорирование,
как неактуального.

\section{Обзор программных решений для сертификации ПО на отсутствие НДВ}\label{sec:ch1/sec3}
На сегодняшний день не существует в комплексных разработок по сертификации программного обеспечения
на предмет НДВ. Однако, существуют программы, специализирующиеся отдельно на анализе исходных кодов
и отдельно исполняемого файла. Рассмотрим их по отдельности

\subsection{Обзор статических анализаторов}\label{sec:ch1/sec3/sub1}
{\small
    \setlength{\tabcolsep}{2pt}
    \setlength\LTleft{-1cm}
    \setlength\LTright{-1cm}
    \begin{longtable}{*{6}{| c}|}
        \hline
            \makecell{Название\\программы}         &
            \makecell{Особенность}                 &
            \makecell{Кросс\\-\\платфор\\менность} &
            \makecell{Поддер-\\живаемые\\языки}    &
            \makecell{Доступность}                 &
            \makecell{Недостатки\\и\\Достоинства}  \\
        \hline
            \makecell{Microsoft\\Application\\Inspector
                      \autocite{microsoft-application-inspector}}           &
            \makecell[l]{
             Систематическая\\
             и масштабируемая\\
             идентификация\\
             функций\\исходного кода}                                       &
             \greencell{Есть}                                                &
             \makecell{34 языка и\\распознает\\их смешение}                 &
             \greencell{\makecell{Бесплатна,\\ с открытым\\исходным\\кодом}} &
             \makecell[l]{
             \textbf{Недостатки:}\\
              Проводит предметный\\
              анализ функций, но\\
              ничего не говорит\\
              о последовательности\\
              их вызова\\
             \textbf{Достоинства:}\\
              Несколько\\форматов\\отчета}\\
        \hline
            \makecell{SCI\\Tools\\Understand
                      \autocite{sci-tools-understand}} &
            \makecell[l]{
             Быстрый\\
             статический\\
             анализ больших\\
             объемов кода,\\
             возможность\\
             визуализации\\
             отношений,\\
             различные\\
             метрики.
             } &
             \greencell{Есть} &
             \makecell{Около 20} &
             \redcell{\makecell{Платна,\\закрытый\\исходный\\код}} &
             \makecell[l]{
             \textbf{Недостатки:}\\
             Программа платная,\\
             с закрытым исходным\\
             кодом\\
             \textbf{Достоинства:}\\
             Возможность писать\\
             скрипты для\\
             доступа к\\
             проектной БД,\\
             генерирования\\
             собственных метрик,\\
             отчетов и т.д.}\\
        \hline
            \makecell{GNU cflow
                      \autocite{gnu-cflow}} &
            \makecell[l]{
             Быстрый\\
             и минималистичный\\
             статический\\
             анализатор,\\
             позволяющий\\
             создавать как\\
             прямые, так и\\
             обратные графы\\
             вызовов.\\
             Прогрммный\\
             интерфейс\\
             приближен к\\
             программному\\
             интерфейсу\\
             компилятора.
             } &
             \greencell{Есть} &
             \makecell{C/C++} &
             \greencell{\makecell{Бесплатна,\\ с открытым\\исходным\\кодом}} &
             \makecell[l]{
             \textbf{Недостатки:}\\
             Поддерживаются\\
             только\\
             языки С и C++\\
             \textbf{Достоинства:}\\
             Минималистичность\\
             отчета.\\
             Возможность строить\\
             как прямые,\\
             так и\\
             обратные графы\\
             вызовов.}\\
        \hline
    \caption{\label{table:static-analyzers-review}
           Обзорная таблица статических анализаторов}
    \end{longtable}
}

\subsection{Обзор динамических анализаторов}\label{sec:ch1/sec3/sub2}
{\small
    \setlength{\tabcolsep}{2pt}
    \begin{longtable}{*{5}{| c}|}
        \hline
            \makecell{Название\\программы}         &
            \makecell{Особенность}                 &
            \makecell{Кросс\\-\\платфор\\менность} &
            \makecell{Недостатки\\и\\Достоинства}  \\
        \hline
            \makecell{GNU Debugger \autocite{gdb}} &
            \makecell[l]{
             Отладчик GDB\\
             может запускаться\\
             на большом количестве\\
             платформ.\\
             Есть возможность\\
             программирования\\
             самого отладчика}        &
             \greencell{Есть}          &
             \makecell[l]{
             \textbf{Недостатки:}\\
             Некоторые команды\\
             не работают в batch\\
             режиме.\\
             \textbf{Достоинства:}\\
             Можно проводить\\
             удаленную отладку\\
             программ.\\}\\
        \hline
            \makecell{QEMU \autocite{qemu}} &
            \makecell[l]{
             Быстрый эмулятор\\
             процессоров.\\
             Предоставляет\\
             возможность\\
             сохранять\\
             сгенерированный\\
             машинный код}             &
             \greencell{Есть}           &
             \makecell[l]{
             \textbf{Недостатки:}\\
             Преобразование всех\\
             инструкций программы\\
             будет занимать\\
             значительное время,\\
             в отличие от\\
             точек останова,\\
             которые ставит GDB.\\
             \textbf{Достоинства:}\\
             Возможность\\
             сохранять\\
             сгенерированный\\
             машинный код}\\
        \hline
    \caption{\label{table:dynamic-analyzer-review}
           Обзорная таблица программ для проведения динамического анализа}
    \end{longtable}
}

\subsection{Сравнение статических анализаторов}\label{sec:ch1/sec3/sub3}
{\small
    \setlength{\tabcolsep}{2pt}
    \begin{longtable}{*{4}{| c}|}
        \hline
        \diagbox[width=8cm]{Свойства}{Название программы}                                       &
        \makecell{Microsoft\\Application\\Inspector \autocite{microsoft-application-inspector}} &
        \makecell{SCI\\Tools\\Understand \autocite{sci-tools-understand}}                       &
        \makecell{GNU cflow \autocite{gnu-cflow}} \\
        \hline
        \makecell{Кросс-платформенность}             & \greencell{Да} & \greencell{Да} & \greencell{Да}\\
        \hline
        \makecell{Открытость\\исходного кода}        & \greencell{Да} & \redcell{Нет}   & \greencell{Да}\\
        \hline
        \makecell{Препроцессирование\\кода C/C++}    & \redcell{Нет}   & \greencell{Да} & \greencell{Да}\\
        \hline
        \makecell{Представление\\
                  препроцессорных директив как\\
                  вызов функций}                     & \redcell{Нет}   & \redcell{Нет}   & \greencell{Да}\\
        \hline
        \makecell{Создание графа вызовов}            & \redcell{Нет}   & \greencell{Да} & \greencell{Да} \\
        \hline
        \makecell{Создание обратного\\графа вызовов} & \redcell{Нет}   & \greencell{Да} & \greencell{Да}\\
        \hline
        \makecell{Бесплатность}                      & \greencell{Да} & \redcell{Нет}   & \greencell{Да}\\
        \hline
        \makecell{Графический интерфейс}             & Нет & Есть & Нет \\
        \hline
    \caption{\label{table:static-analyzers-comparsion}
           Сравнительная таблица статических анализаторов}
    \end{longtable}
}

\textbf{Вывод:} так как {\ProgModule} ориентирован на анализ C/C++ программ, то проанализировав
\autoref{table:static-analyzers-comparsion} приходим к выводу, что функционал 
Microsoft Application Inspector \autocite{microsoft-application-inspector}
не покрывает нужные сценарии использования, 
а SCI Tools Understand \autocite{sci-tools-understand} не подходит
из-за своей закрытости и платности. Единственный возможнный выбор -- GNU cflow \autocite{gnu-cflow}

\subsection{Сравнение динамических анализаторов}\label{sec:ch1/sec3/sub4}
{\small
    \setlength{\tabcolsep}{2pt}
    \begin{longtable}{*{3}{| c}|}
        \hline
        \diagbox[width=8cm]{Свойства}{Название программы} &
        \makecell{GDB \autocite{gdb}}                     &
        \makecell{QEMU \autocite{qemu}}                   \\
        \hline
        \makecell{Кросс-платформенность}             & \greencell{Да} & \greencell{Да} \\
        \hline
        \makecell{Открытость\\исходного кода}        & \greencell{Да} & \greencell{Да} \\
        \hline
        \makecell{Возможность\\анализировать память} & \greencell{Да} & \greencell{Да} \\
        \hline
        \makecell{Возможность\\программно управлять} & \greencell{Да} & \greencell{Да} \\
        \hline
        \makecell{Возможность\\создавать\\
                  собственные команды}               & \greencell{Да} & \redcell{Нет}   \\
        \hline
        \makecell{Возможность удаленной\\
                  отладки}                           & \greencell{Да} & \redcell{Нет}   \\
        \hline
        \makecell{Бесплатность}                      & \greencell{Да} & \greencell{Да} \\
        \hline
        \makecell{Графический интерфейс}             & Есть & Есть \\
        \hline
    \caption{\label{table:dynamic-analyzers-comparsion}
           Сравнительная таблица программ для динамического анализа}
    \end{longtable}
}

\textbf{Вывод:} Так как для более точного выполнения задачи сертификации будет полезно получать
информацию времени выполнения программы, такую, как:
\begin{enumerate}
    \item Значения регистров перед вызовом функции
    \item Состояние стека перед вызовом функции
    \item Стек вызовов
    \item Экспертиза результатов
    \item Информацию о сегментах и функциях в них определенных
\end{enumerate}
А так же расширять возможность динамического анализатора с помощью скриптов,
то из \autoref{table:dynamic-analyzers-comparsion} следует, что
удобнее всего это можно будет сделать с помощью отладчика GDB \autocite{gdb},
нежели эмулятора QEMU \autocite{qemu}.
